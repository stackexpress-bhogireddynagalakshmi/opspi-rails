<%= render partial: 'spree/admin/shared/error_messages', locals: { target: @product } %>
<style type="text/css">
  .formSuccess{
    color: green;
  }
</style>

<% content_for :page_title do %>
 <div class="mt-2"></div>
  <%= link_to Spree.t(:domain), admin_windows_domains_path %> /
  <%= Spree.t(:new_domain) %>
<% end %>


<% url =  @api_resource.present? ?   admin_windows_domain_path(@api_resource.domain_id) : admin_windows_domains_path%>

 <%=form_for "web_domain", url: url, html: { method: @api_resource.present? ? :put : :post } do |f|%> 
  <%resource  = @api_resource || @proxy_resource%>



  <%=hidden_field_tag :domain_id, resource.try("domain_id")%>
  <fieldset>
    <div class="form-group field">
      <label>Web Domain Name</label>
      <%=f.text_field 'domain_name', value: resource.try(:domain_name), class: 'form-control'%>
      <span id="domain-validation-msg" style="color: red;"> <%=@validation.try(:[],1)%></span>
    </div>

    <h5 class="mt-4">Provisioning Options</h5>

    <div class="form-group field">
      <label><%=f.check_box :create_webSite, class: 'mr-2'%> Create Web Site</label>


      <%#=f.select 'create_webSite',options_for_select([['Yes',true], ['No',false]], resource.try(:enable_dns)),{}, class: 'form-control'%>
      <p class="text-muted mt-2 pl-4">Create a new web site.</p>
    </div>

     <div class="form-group field">
      <label><%=f.check_box :point_to_existing_website, class: 'mr-2'%> Assign to existing Web Site.</label>
      <%=f.select 'point_website_id',options_for_select([], resource.try(:point_website_id)),{}, class: 'form-control ml-4', disabled: true%>
    
    </div>

          
    <div class="form-group field">
      <label><%=f.check_box :enable_dns, class: 'mr-2'%>  Enable DNS</label>
      <%#=f.select 'enable_dns',options_for_select([['Yes',true], ['No',false]], resource.try(:enable_dns)),{}, class: 'form-control'%>
      <p class="text-muted mt-2 pl-4">Tick this checkbox if DNS zone for this domain will be located on name servers of your hosting provider. Make sure you changed name servers in the domain registrar control panel.</p>
    </div>

    <div class="form-group field">
      <label><%=f.check_box :allow_subdomains, class: 'mr-2'%> Allow customer sub-domains</label>

      <%#=f.select 'allow_subdomains',options_for_select([['Yes',true], ['No',false]], resource.try(:enable_dns)),{}, class: 'form-control'%>
      <p class="text-muted mt-2 pl-4">Tick this option if you like to offer this domain to your customers to create their own free sub-domains.</p>
    </div>



    <%=submit_tag "#{resource.present? ? 'Update' : 'Add'} Domain", class: 'btn btn-primary'%>

  </fieldset>
<%end%>

<div>
 
  <%if @response && @response["status"]=='ERROR'%>
    <div style="color: red;" class="mt-3"><%=@response["message"]%></</div> 
  <%end%>
</div>




<script type="text/javascript">
  $(document).ready(function (argument) {
    $('#FlashAlertsContainer').removeClass('d-none');


    $('#web_domain_create_webSite').on('change', function (argument) {
      
        if(this.checked){
          $('#web_domain_point_to_existing_website').removeAttr('checked');
          $('#web_domain_point_to_existing_website').attr('disabled', 'disabled');
          $('#web_domain_point_website_id').attr('disabled','disabled')
        }
        else {
          $('#web_domain_point_to_existing_website').removeAttr('disabled');
        }
       
    });


    $('#web_domain_point_to_existing_website').on('change', function (argument) {
      
        if(this.checked){
          $('#web_domain_create_webSite').removeAttr('checked');
          $('#web_domain_create_webSite').attr('disabled', 'disabled');
          $('#web_domain_point_website_id').removeAttr('disabled')
        }
        else {
          $('#web_domain_point_website_id').attr('disabled','disabled');
        }
       
    });


  });
</script>
