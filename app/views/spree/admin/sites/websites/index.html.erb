<% content_for :page_title do %>
 Websites
<% end %>
<% content_for :page_actions do %>
  <%= button_link_to Spree.t(:add_website),
    new_admin_sites_website_path,
    class: "btn-success",
      icon: 'add.svg',
      id: 'admin_new_website' %>
<% end %>

<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Linux </a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Windows</a>
  </li>

</ul>
<div class="tab-content" id="myTabContent">
  <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
      <% if @resources.any? %>
        <div data-nav-x-wrapper>
          <div data-nav-x-container>
            <table class="table" id="listing_orders" data-hook data-nav-x-content>
              <thead>
                <tr data-hook="admin_orders_index_headers">
                  <th>ID</th>
                  <th>Domain</th>
                  <th>Document Root</th>
                  <th>Active</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <%= render partial: 'spree/admin/sites/websites/index', collection: @resources, as: :website %>
              </tbody>
            </table>
          </div>
        </div>
      <% else %>
        <div class="alert alert-info no-objects-found">
          No Websites
        </div>
      <% end %>

  </div>
  <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
      <% if @windows_resources.any? %>
      <div data-nav-x-wrapper>
        <div data-nav-x-container>
          <table class="table" id="listing_orders" data-hook data-nav-x-content>
            <thead>
              <tr data-hook="admin_orders_index_headers">
                <th>Domain Name</th>
                <th>Expiration Date</th>
                <th>Type</th>
               
              </tr>
            </thead>
            <tbody>

            <%@windows_resources.reverse.each do |domain| %>
              <tr data-hook="admin_orders_index_rows" class="<%= cycle('odd', 'even') %>">
                <td><%=domain.domain_name%></td>
                <td><%=domain.expiration_date%></td>
                <td><%=domain.is_sub_domain? ? 'Sub-Domain' : "Top-level Domain" %></td>
                
                <td><%=link_to 'Edit',edit_admin_windows_domain_path(id: domain.domain_id)%> |
                  <%=link_to 'Delete', admin_windows_domain_path(id: domain.domain_id), method: :delete, data: {confirm: t('isp_config.mail_domain.delete_alert')}%>
                </td>  
              </tr>
            <% end %>
            </tbody>
          </table>
        </div>
      </div>
      <% else %>
        <div class="alert alert-info no-objects-found">
        
        </div>
      <% end %>

  </div>
</div>



<script type="text/javascript">
  
  $(function () {
    $('[data-toggle="tooltip"]').tooltip();
  })

  $(document).ready(function (argument) {
    $('#FlashAlertsContainer').removeClass('d-none');

  });

  var updateWebDomain = function(element){
    var webDomainId = element.attributes.data_web_domain_id.value;
    var domainStatus = element.value;
    if (domainStatus == 'y') {
      var dataConfirm = "Are you sure to Deactivate this Domain?, This will affect your other services";
      var active = 'n';
    }
    else {
      var dataConfirm = "Are you sure to Activate this Domain?";
      var active = 'y';
    }

    result = confirm(dataConfirm);
    if (result) {
      setTimeout(function(){
        $.ajax({
          type: "PATCH",
          url: "/admin/sites/websites/"+webDomainId,
          data: { 
            website: {
              active: active
            }
          }
        });
      } ,5);
    }
  }

  if($("#sidebar-hosting_controls a").hasClass("collapsed")){
    $('a').attr("aria-expanded","false");  
  } else {
    $('a').attr("aria-expanded","true");
    $('#sidebar-hosting_controls').addClass("show");
    $('#sidebar-sites').addClass("show");
  }
</script>

